System.register(["./index-legacy-Dr3Ksir8.js","./vue-vendor-legacy-ikyms0Ip.js","./skeleton-legacy-XkooQtmU.js","./spin-legacy-CX9iz6gd.js","./index-legacy-D_zaI8lQ.js","./department.service-legacy-C-d8KqWW.js","./vue3-count-to.esm-legacy-CowH55Wj.js","./antd-vendor-legacy-DsFsidym.js","./_plugin-vue_export-helper-legacy-DgAO6S8O.js"],(function(e,t){"use strict";var a,n,o,d,l,r,c,s,u,i,p,m,f,g,y,v,x,b,I,k,_,h,w,O,R,j,S,$,C,L,N,T,z,A,D;return{setters:[e=>{a=e.i,n=e.u,o=e._},e=>{d=e.d,l=e.ab,r=e.u,c=e.a7,s=e.r,u=e.a,i=e.w,p=e.a4,m=e.a5,f=e.a6,g=e.c,y=e.aj,v=e.G,x=e.af,b=e.a9,I=e.F,k=e.al,_=e.ag,h=e.h},e=>{w=e.Q},e=>{O=e.Q},e=>{R=e.u},e=>{j=e.D},e=>{S=e.C},e=>{$=e.F,C=e.J,L=e.B,N=e.X,T=e.Y,z=e.Z,A=e.$},e=>{D=e._}],execute:function(){const P=e("A",{1:{text:"正常",color:"#52c41a"},2:{text:"旷工",color:"#ff4d4f"},3:{text:"迟到",color:"#faad14"},4:{text:"早退",color:"#faad14"},5:{text:"外出",color:"#1890ff"},6:{text:"出差",color:"#1890ff"},7:{text:"年假",color:"#52c41a"},8:{text:"事假",color:"#faad14"},9:{text:"病假",color:"#faad14"},10:{text:"婚假",color:"#52c41a"},11:{text:"丧假",color:"#8c8c8c"},12:{text:"产假",color:"#52c41a"},13:{text:"奖励产假",color:"#52c41a"},14:{text:"陪产假",color:"#52c41a"},15:{text:"探亲假",color:"#52c41a"},16:{text:"工伤假",color:"#faad14"},17:{text:"调休",color:"#52c41a"},18:{text:"产检假",color:"#52c41a"},19:{text:"流产假",color:"#faad14"},20:{text:"长期病假",color:"#faad14"},21:{text:"补签",color:"#1890ff"},22:{text:"休息",color:"#8c8c8c"},99:{text:"-",color:"#8c8c8c"}});class U{static getAttendanceList(e){return a.get("/attendances",{params:e})}static getCompanyList(){return a.get("/company/list")}static updateCompanyList(e){return a.put("/company/list",{data:e})}static updateAttendance(e,t){return a.put(`/attendances/${e}`,{data:t})}static getAttendancesAdtStatuList(e){return a.get("/attendances/adtStatu/list",{params:{userId:e}})}}e("a",U);const B={class:"attendance-middle-checkbox-group"},G={class:"attendance-table"},M=D(d({name:"AttendancePage",__name:"index",setup(e){l((e=>({"6a78231f":`${r(F).paddingLG}px`,"2c753592":r(F).colorBgContainer,"0dfce7fc":`${r(F).borderRadiusLG}px`,"4c790b7e":r(F).colorBorderSecondary,"8b2ca8e4":`${r(F).fontSizeLG}px`,"61ab6ef2":`${r(F).fontSizeXL}px`,"11b6d538":`${r(F).padding}px`,65500879:r(F).colorBgElevated})));const a=_((()=>o((()=>t.import("./table-popover-legacy-CyQn8pz1.js")),void 0))),d=_((()=>o((()=>t.import("./modal-legacy-D2MrU_L1.js")),void 0))),D=_((()=>o((()=>t.import("./update-attendance-legacy-ZNaNFeBb.js")),void 0))),M=_((()=>o((()=>t.import("./drawer-legacy-BM-nN1E-.js").then((e=>e.d))),void 0))),{token:F}=R(),{t:Q}=c(),X=s([]),E=s([]),J=s(!1),Y=s(!1),Z=s(!1),q=[{title:Q("attendance.table.columns.key"),dataIndex:"key",key:"key",width:80,fixed:"left"},{title:Q("attendance.table.columns.username"),dataIndex:"username",key:"username",width:150,fixed:"left"},{title:Q("attendance.table.columns.workNumber"),dataIndex:"workNumber",key:"workNumber",width:150,fixed:"left"},{title:Q("attendance.table.columns.departmentName"),dataIndex:"departmentName",key:"departmentName",width:150,fixed:"left"},{title:Q("attendance.table.columns.mobile"),dataIndex:"mobile",key:"mobile",width:150,fixed:"left"}],H=s(q),K=u({total:0,rows:[]}),V=u({monthOfReport:1,tobeTaskCount:0,dayOfMonth:0,yearOfReport:2026,attendanceRecord:[]}),W=u({page:1,pagesize:10,deptID:E.value.join(",")}),ee=u({day:"",adtStatu:0,userId:0,departmentId:0}),te=e=>{const t=[],{yearOfReport:n,monthOfReport:o}=V;for(let d=1;d<=e;d++){const e=`${n}/${o}/${d}`;t.push({title:`${o}/${d}`,dataIndex:e,key:e,width:80,align:"center",customRender:({text:t,record:l})=>{const r=l.attendanceRecord.find((t=>t.day===e));return P[t]?h(a,{username:l.username,yearOfReport:n,monthOfReport:o,dayOfReport:d,adtStatu:t,adtInTime:r?.adtInTime,adtOutTime:r?.adtOutTime,adtInPlace:r?.adtInPlace,adtOutPlace:r?.adtOutPlace,onClick:()=>{ee.userId=l.id??0,ee.departmentId=l.departmentId,ee.day=e,ee.adtStatu=t,Z.value=!0}}):t}})}return t},ae=(e,t)=>{Object.assign(W,{page:e,pagesize:t}),ne(W)},{run:ne,loading:oe}=n(U.getAttendanceList,{onSuccess:({data:e})=>{const{yearOfReport:t,monthOfReport:a,tobeTaskCount:n,data:{rows:o}}=e;Object.assign(V,{tobeTaskCount:n,dayOfMonth:new Date(t,a,0).getDate(),attendanceRecord:o,yearOfReport:t,monthOfReport:a}),K.rows=(e=>{const{yearOfReport:t,monthOfReport:a}=V;return e.map((e=>({key:e.id,id:e.id,departmentId:e.departmentId,departmentName:e.departmentName,mobile:e.mobile,username:e.username,workNumber:e.workNumber,attendanceRecord:e.attendanceRecord,...e.attendanceRecord.reduce(((e,n)=>{const o=parseInt(n.day.slice(6));return{...e,[`${t}/${a}/${o}`]:n.adtStatu}}),{})})))})(o),K.total=e.data.total}}),{loading:de}=n(j.getCompanyDepartmentList,{onSuccess:({data:e})=>{X.value=e.map((e=>({label:e.name,value:e.id})))}});return i((()=>V.dayOfMonth),(e=>{e>0&&(H.value=[...q,...te(e)])})),i((()=>E.value),(()=>{W.deptID=E.value.join(","),ne(W)})),(e,t)=>(m(),p(r($),{class:"attendance-wrapper h-full",vertical:"",gap:"middle"},{default:f((()=>[g(r($),{justify:"space-between",align:"center",class:"attendance-top"},{default:f((()=>[g(r($),{vertical:"",align:"center",gap:"small"},{default:f((()=>[g(r(C),{class:"attendance-top-title"},{default:f((()=>[v(x(r(Q)("attendance.top.unprocessed")),1)])),_:1}),g(r(w),{paragraph:!1,active:"",loading:r(oe)},{default:f((()=>[g(r(S),{"start-val":0,"end-val":V.tobeTaskCount,duration:3e3,class:"attendance-top-total"},null,8,["end-val"])])),_:1},8,["loading"])])),_:1}),g(r($),{gap:"middle"},{default:f((()=>[g(r(L),{onClick:t[0]||(t[0]=e=>J.value=!0)},{default:f((()=>[v(x(r(Q)("attendance.actions.clockInRange")),1)])),_:1}),g(r(L),{type:"primary",onClick:t[1]||(t[1]=e=>Y.value=!0)},{default:f((()=>[v(x(r(Q)("attendance.actions.settings")),1)])),_:1})])),_:1})])),_:1}),g(r($),{class:"attendance-middle",gap:"small",align:"flex-start"},{default:f((()=>[g(r(N),{class:"attendance-middle-label",level:5},{default:f((()=>[v(x(r(Q)("attendance.filter.department"))+": ",1)])),_:1}),g(r(w),{active:"",title:!1,loading:r(de),paragraph:{rows:2}},{default:f((()=>[g(r(T),{value:E.value,"onUpdate:value":t[2]||(t[2]=e=>E.value=e),class:"w-full"},{default:f((()=>[y("div",B,[(m(!0),b(I,null,k(X.value,(e=>(m(),p(r(z),{key:e.value.toString(),value:e.value},{default:f((()=>[v(x(e.label),1)])),_:2},1032,["value"])))),128))])])),_:1},8,["value"])])),_:1},8,["loading"])])),_:1}),y("div",G,[g(r(O),{spinning:r(oe)},{default:f((()=>[g(r(A),{pagination:{position:["bottomCenter"],pageSize:W.pagesize,total:K.total,current:W.page,onChange:ae,showTotal:e=>r(Q)("attendance.table.pagination.total",{total:e})},columns:H.value,"data-source":K.rows,scroll:{x:"max-content"},bordered:""},null,8,["pagination","columns","data-source"])])),_:1},8,["spinning"])]),g(r(M),{open:J.value,"onUpdate:open":t[3]||(t[3]=e=>J.value=e)},null,8,["open"]),g(r(d),{open:Y.value,"onUpdate:open":t[4]||(t[4]=e=>Y.value=e)},null,8,["open"]),g(r(D),{day:ee.day,adtStatu:ee.adtStatu,userId:ee.userId,departmentId:ee.departmentId,open:Z.value,"onUpdate:open":t[5]||(t[5]=e=>Z.value=e),onUpdate:t[6]||(t[6]=e=>r(ne)(W))},null,8,["day","adtStatu","userId","departmentId","open"])])),_:1}))}}),[["__scopeId","data-v-bef77a1a"]]),F=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"}));e("i",F)}}}));
