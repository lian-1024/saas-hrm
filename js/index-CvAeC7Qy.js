const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/role-modal-Ca0_PUv4.js","js/employee.service-C0m8ECzY.js","js/index-CI1igBQZ.js","js/vue-vendor-I_PSXyJa.js","js/antd-vendor-T3zku5__.js","js/lodash-vendor-DOy_biNW.js","js/axios-vendor-cIIFlI1p.js","js/role.service-BC77x9tf.js","js/modal.vue_vue_type_script_setup_true_lang-BwdYvTp8.js","js/index-YJ2Yz_0y.js","js/spin-f7H7F6Je.js","js/_plugin-vue_export-helper-DlAUqK2U.js","js/import-excel-modal-BTOreLFv.js","js/avatar.vue_vue_type_script_setup_true_lang-DO-hdSc-.js","js/skeleton-DY1tZivi.js","js/department.service-BmOWA-Yr.js","js/department-Ccp6HD3_.js","js/mass-notification-qsQsBmyz.js","js/message-B_TRrMgK.js"])))=>i.map(i=>d[i]);
import{c as de,u as F,r as W,_ as $}from"./index-CI1igBQZ.js";import{d as ue,a9 as fe,a5 as ye,s as ve,a as ge,r as _,j as V,am as Ee,w as we,o as be,v as _e,a2 as C,a3 as k,a4 as r,c as i,u as e,an as J,G as y,ad as v,q as ke,a7 as he,F as xe,ae as q}from"./vue-vendor-I_PSXyJa.js";import{_ as Se}from"./avatar.vue_vue_type_script_setup_true_lang-DO-hdSc-.js";import{Q as Oe}from"./skeleton-DY1tZivi.js";import{Q as Le}from"./spin-f7H7F6Je.js";import{u as Re}from"./index-YJ2Yz_0y.js";import{D as Ce}from"./department.service-BmOWA-Yr.js";import{E as G,F as Z}from"./employee.service-C0m8ECzY.js";import{D as Te}from"./department-Ccp6HD3_.js";import{af as I,j as Pe,h as A,F as h,ag as De,ac as Me,B as E,a1 as Fe,ah as Ie,O as Ae}from"./antd-vendor-T3zku5__.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";var N={exports:{}},Ne=N.exports,ee;function ze(){return ee||(ee=1,function(H,z){(function(f,a){a()})(Ne,function(){function f(t,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function a(t,o,d){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){m(n.response,o,d)},n.onerror=function(){console.error("could not download file")},n.send()}function T(t){var o=new XMLHttpRequest;o.open("HEAD",t,!1);try{o.send()}catch(d){}return 200<=o.status&&299>=o.status}function w(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(d){var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(o)}}var u=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof I=="object"&&I.global===I?I:void 0,b=u.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=u.saveAs||(typeof window!="object"||window!==u?function(){}:"download"in HTMLAnchorElement.prototype&&!b?function(t,o,d){var n=u.URL||u.webkitURL,c=document.createElement("a");o=o||t.name||"download",c.download=o,c.rel="noopener",typeof t=="string"?(c.href=t,c.origin===location.origin?w(c):T(c.href)?a(t,o,d):w(c,c.target="_blank")):(c.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(c.href)},4e4),setTimeout(function(){w(c)},0))}:"msSaveOrOpenBlob"in navigator?function(t,o,d){if(o=o||t.name||"download",typeof t!="string")navigator.msSaveOrOpenBlob(f(t,d),o);else if(T(t))a(t,o,d);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){w(n)})}}:function(t,o,d,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return a(t,o,d);var c=t.type==="application/octet-stream",B=/constructor/i.test(u.HTMLElement)||u.safari,P=/CriOS\/[\d]+/.test(navigator.userAgent);if((P||c&&B||b)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var g=x.result;g=P?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=g:location=g,n=null},x.readAsDataURL(t)}else{var S=u.URL||u.webkitURL,O=S.createObjectURL(t);n?n.location=O:location.href=O,n=null,setTimeout(function(){S.revokeObjectURL(O)},4e4)}});u.saveAs=m.saveAs=m,H.exports=m})}(N)),N.exports}var Be=ze();const Ue=Pe(Be),$e={ADD_EMPLOYEE:"add_employee"},j="middle",Ve=ue({name:"EmployeePage",__name:"index",setup(H){var Q,K,X;fe(l=>({"7409e97b":"".concat(e(f).borderRadiusLG,"px"),cbd343c2:e(f).colorBorderSecondary,f3bc2380:"".concat(e(f).paddingLG,"px"),"481f00b3":e(f).colorBgContainer,"5282cf6e":e(z)&&"transparent",f59824dc:e(z)?e(f).colorPrimary:e(f).colorPrimaryHover}));const{isDark:z}=de(),{token:f}=Re(),{t:a}=ye(),T=q(()=>$(()=>import("./role-modal-Ca0_PUv4.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),w=q(()=>$(()=>import("./import-excel-modal-BTOreLFv.js"),__vite__mapDeps([12,3,1,2,4,5,6,8,9,11,13,14,10,15,16]))),u=q(()=>$(()=>import("./mass-notification-qsQsBmyz.js"),__vite__mapDeps([17,3,8,9,4,5,2,6,18,1,11]))),b=ve(),m=ge({departmentId:(X=(K=(Q=b.value)==null?void 0:Q[0])==null?void 0:K.id)!=null?X:1,keyword:"",page:1,pagesize:10}),t=_(!1),o=V(()=>[{title:a("employee.table.columns.staffPhoto"),dataIndex:"staffPhoto",key:"staffPhoto",width:80},{title:a("employee.table.columns.username"),dataIndex:"username",key:"username"},{title:a("employee.table.columns.mobile"),dataIndex:"mobile",key:"mobile"},{title:a("employee.table.columns.workNumber"),dataIndex:"workNumber",key:"workNumber"},{title:a("employee.table.columns.formOfEmployment"),dataIndex:"formOfEmployment",key:"formOfEmployment"},{title:a("employee.table.columns.departmentName"),dataIndex:"departmentName",key:"departmentName"},{title:a("employee.table.columns.timeOfEntry"),dataIndex:"timeOfEntry",key:"timeOfEntry"},{title:a("employee.table.columns.operations"),key:"operations",fixed:"right",width:180}]),d=Ee({total:0,rows:[]}),n=_(!1),c=_(null),B=["bottomRight"],P=["5","10","20","30","40","50"],x=l=>{n.value=!0,c.value=l},{loading:S,run:O}=F(Ce.getCompanyDepartmentList,{manual:!0,onSuccess:({data:l})=>{b.value=Te.toTree(l)}}),{loading:g,run:L}=F(()=>G.getEmployeeList(m),{manual:!0,onSuccess:({data:l})=>{d.rows=l.rows.map(s=>({...s,key:s.id})),d.total=l.total}}),{run:te}=F(G.deleteEmployee,{manual:!0,onSuccess:()=>{A.success(a("employee.messages.deleteSuccess")),L(m)},onError:l=>{l.message?A.error(l.message):A.error(a("employee.messages.deleteError"))}}),{run:oe,loading:ae}=F(G.exportEmployeeList,{manual:!0,onSuccess:l=>{console.log(l),Ue.saveAs(l.data,"员工列表.xlsx")}}),ne=l=>{W.push("/employee/detail/".concat(l))},le=()=>{W.push("/employee/detail")},se=l=>{m.departmentId=Number(l[0])},re=(l,s)=>{m.page=l,m.pagesize=s,L(m)};we(()=>m.departmentId,l=>{L(m)}),be(async()=>{await Promise.all([O(),L()])});const ie=l=>me[l].value,me={[Z.Formal]:V(()=>a("employee.table.formalOfEmployment.formal")),[Z.InFormal]:V(()=>a("employee.table.formalOfEmployment.informal"))},U=_([]),pe=_({onChange(l,s){U.value=s.map(M=>({id:M.id,username:M.username}))}}),D=_(!1),ce=()=>{U.value.length>0?D.value=!0:A.warning(a("employee.messages.noSelectedEmployee")),console.log(D.value)};return(l,s)=>{const M=_e("permission");return k(),C(e(h),{gap:"small",class:"h-full employee-wrapper"},{default:r(()=>[i(e(h),{vertical:"",class:"employee-left",gap:"middle"},{default:r(()=>[i(e(De),{onSearch:s[0]||(s[0]=p=>e(L)(m)),placeholder:e(a)("employee.search.placeholder"),value:m.keyword,"onUpdate:value":s[1]||(s[1]=p=>m.keyword=p)},null,8,["placeholder","value"]),i(e(Oe),{loading:e(S),active:"",title:!1,paragraph:{rows:16}},{default:r(()=>[e(S)?J("",!0):(k(),C(e(Me),{key:0,class:"draggable-tree h-full",draggable:"","block-node":"","tree-data":b.value,"default-expand-all":"",onSelect:se},null,8,["tree-data"]))]),_:1},8,["loading"])]),_:1}),i(e(h),{vertical:"",gap:"small",class:"flex-1 employee-right h-full"},{default:r(()=>[i(e(h),{justify:"space-between",class:"employee-right-actions"},{default:r(()=>[i(e(E),{size:j,onClick:ce},{default:r(()=>[y(v(e(a)("employee.actions.sendNotification")),1)]),_:1}),i(e(h),{gap:"small"},{default:r(()=>[ke((k(),C(e(E),{type:"primary",size:j,onClick:s[2]||(s[2]=()=>le())},{default:r(()=>[y(v(e(a)("employee.actions.addEmployee")),1)]),_:1})),[[M,e($e).ADD_EMPLOYEE]]),i(e(E),{size:j,onClick:s[3]||(s[3]=p=>t.value=!0)},{default:r(()=>[y(v(e(a)("employee.actions.importExcel")),1)]),_:1}),i(e(E),{loading:e(ae),size:j,onClick:e(oe)},{default:r(()=>[y(v(e(a)("employee.actions.exportExcel")),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1}),i(e(Le),{spinning:e(g),"wrapper-class-name":"flex-1 h-full"},{default:r(()=>[i(e(Fe),{pagination:{position:B,pageSizeOptions:P,total:e(d).total,current:m.page,onChange:re,showTotal:p=>e(a)("employee.table.pagination.total",{total:p})},class:"flex-1 h-full employee-right-table",columns:o.value,"data-source":e(d).rows,"row-selection":pe.value},{headerCell:r(({title:p})=>[i(e(Ae),{type:"secondary",level:5,class:"table-header-title"},{default:r(()=>[y(v(p),1)]),_:2},1024)]),bodyCell:r(({column:p,record:R})=>[p.key==="staffPhoto"?(k(),C(e(Se),{key:0,src:R.staffPhoto},null,8,["src"])):p.key==="formOfEmployment"?(k(),he(xe,{key:1},[y(v(ie(R.formOfEmployment)),1)],64)):p.key==="operations"?(k(),C(e(h),{key:2},{default:r(()=>[i(e(E),{type:"link",size:"small",onClick:Y=>ne(R.key)},{default:r(()=>[y(v(e(a)("employee.table.actions.view")),1)]),_:2},1032,["onClick"]),i(e(E),{type:"link",size:"small",onClick:Y=>x(R.key)},{default:r(()=>[y(v(e(a)("employee.table.actions.role")),1)]),_:2},1032,["onClick"]),i(e(Ie),{onConfirm:Y=>e(te)(R.key),title:e(a)("employee.table.actions.deleteConfirm")},{default:r(()=>[i(e(E),{type:"link",size:"small",danger:""},{default:r(()=>[y(v(e(a)("employee.table.actions.delete")),1)]),_:1})]),_:2},1032,["onConfirm","title"])]),_:2},1024)):J("",!0)]),_:1},8,["pagination","columns","data-source","row-selection"])]),_:1},8,["spinning"]),i(e(T),{open:n.value,"onUpdate:open":s[4]||(s[4]=p=>n.value=p),"employee-id":c.value},null,8,["open","employee-id"]),i(e(w),{open:t.value,"onUpdate:open":s[5]||(s[5]=p=>t.value=p)},null,8,["open"]),i(e(u),{open:D.value,"onUpdate:open":s[6]||(s[6]=p=>D.value=p),employees:U.value},null,8,["open","employees"])]),_:1})]),_:1})}}}),qe=je(Ve,[["__scopeId","data-v-6d0c557e"]]),ot=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"}));export{Ue as F,ot as i};
