import{_ as E}from"./modal.vue_vue_type_script_setup_true_lang-BwdYvTp8.js";import{Q as G}from"./skeleton-DY1tZivi.js";import{u as _}from"./index-CI1igBQZ.js";import{a as g}from"./index-CUpDwP8x.js";import{d as R,af as S,ag as F,r as A,w as M,a5 as O,a2 as I,a3 as i,a4 as e,ah as m,c as u,ad as r,u as t,a7 as Q,F as T,aj as U,G as p}from"./vue-vendor-I_PSXyJa.js";import{h as y,aG as k,N as V,B as L,O as q,n as $}from"./antd-vendor-T3zku5__.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-YJ2Yz_0y.js";import"./axios-vendor-cIIFlI1p.js";import"./lodash-vendor-DOy_biNW.js";import"./spin-f7H7F6Je.js";import"./department.service-BmOWA-Yr.js";import"./vue3-count-to.esm-DUdQsqT0.js";const H={class:"attendance-status"},J={class:"status-note"},K={class:"attendance-status-radio-list"},P=R({__name:"update-attendance",props:S({day:{},adtStatu:{},userId:{},departmentId:{}},{open:{default:!1},openModifiers:{}}),emits:S(["update"],["update:open"]),setup(f,{emit:h}){const o=f,b=h,l=F(f,"open"),c=A(0);M(()=>o.adtStatu,a=>{c.value=a});const v=A([]),B=a=>a.map(n=>Object.entries(n)).flat().map(n=>{const[s,D]=n;return{label:D,value:Number(s)}}),{run:C,loading:x}=_(g.getAttendancesAdtStatuList,{manual:!0,onSuccess:({data:a})=>{v.value=B(a)}}),{t:d}=O(),{run:N,loading:Y}=_(g.updateAttendance,{manual:!0,onSuccess:()=>{y.success(d("attendance.updateModal.messages.updateSuccess")),l.value=!1,b("update")},onError:()=>{y.error(d("attendance.updateModal.messages.updateError"))}});M(()=>o.userId,a=>{console.log("newValue",a),a&&C(a)});const j=()=>{N(o.userId,{adtStatu:c.value,day:$(o.day).format("YYYYMMDD"),departmentId:o.departmentId,userId:o.userId})},w=()=>{l.value=!1};return(a,n)=>(i(),I(t(E),{open:l.value,"onUpdate:open":n[1]||(n[1]=s=>l.value=s),mask:""},{title:e(()=>[u(t(q),null,{default:e(()=>[p(r(t(d)("attendance.updateModal.title",{date:a.day})),1)]),_:1})]),footer:e(()=>[u(t(V),null,{default:e(()=>[u(t(L),{onClick:w},{default:e(()=>[p(r(t(d)("attendance.updateModal.buttons.cancel")),1)]),_:1}),u(t(L),{type:"primary",loading:t(Y),onClick:j},{default:e(()=>[p(r(t(d)("attendance.updateModal.buttons.confirm")),1)]),_:1},8,["loading"])]),_:1})]),default:e(()=>[m("div",H,[m("p",J,r(t(d)("attendance.updateModal.note")),1),u(t(G),{loading:t(x),active:"",title:!1,paragraph:{rows:8}},{default:e(()=>[u(t(k).Group,{value:c.value,"onUpdate:value":n[0]||(n[0]=s=>c.value=s)},{default:e(()=>[m("div",K,[(i(!0),Q(T,null,U(v.value,s=>(i(),I(t(k),{key:s.value,value:s.value},{default:e(()=>[p(r(s.label),1)]),_:2},1032,["value"]))),128))])]),_:1},8,["value"])]),_:1},8,["loading"])])]),_:1},8,["open"]))}}),ct=z(P,[["__scopeId","data-v-93efe109"]]);export{ct as default};
