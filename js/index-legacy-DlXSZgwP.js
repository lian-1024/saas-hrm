System.register(["./index-legacy-DWXZgdOb.js","./vue-vendor-legacy-ikyms0Ip.js","./avatar.vue_vue_type_script_setup_true_lang-legacy-E7n5GoJT.js","./skeleton-legacy-XkooQtmU.js","./spin-legacy-CX9iz6gd.js","./index-legacy-D_zaI8lQ.js","./department.service-legacy-BkF3W9O-.js","./employee.service-legacy-D3Ei94HF.js","./department-legacy-ZXh46dVA.js","./antd-vendor-legacy-DsFsidym.js","./_plugin-vue_export-helper-legacy-DgAO6S8O.js"],(function(e,t){"use strict";var a,o,l,n,r,i,s,c,d,p,m,u,y,f,g,v,b,w,k,h,_,E,x,j,O,L,C,S,A,R,U,z,I,P,T,D,M,B,F,N,H,q,G,$,Q,X;return{setters:[e=>{a=e.c,o=e.u,l=e.r,n=e._},e=>{r=e.ap,i=e.L,s=e.d,c=e.ab,d=e.a7,p=e.s,m=e.a,u=e.r,y=e.j,f=e.ao,g=e.w,v=e.o,b=e.v,w=e.a4,k=e.a5,h=e.a6,_=e.c,E=e.u,x=e.aq,j=e.G,O=e.af,L=e.q,C=e.a9,S=e.F,A=e.ag},e=>{R=e._},e=>{U=e.Q},e=>{z=e.Q},e=>{I=e.u},e=>{P=e.D},e=>{T=e.E,D=e.F},e=>{M=e.D},e=>{B=e.h,F=e.F,N=e.ad,H=e.aa,q=e.B,G=e.$,$=e.ae,Q=e.J},e=>{X=e._}],execute:function(){var Y,J={exports:{}},K=(Y||(Y=1,function(e){!function(){function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function a(e,t,a){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){s(o.response,t,a)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function l(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r&&r.global===r?r:void 0,i=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,t,r){var i=n.URL||n.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener","string"==typeof e?(s.href=e,s.origin===location.origin?l(s):o(s.href)?a(e,t,r):l(s,s.target="_blank")):(s.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(s.href)}),4e4),setTimeout((function(){l(s)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,r){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,r),n);else if(o(e))a(e,n,r);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){l(i)}))}}:function(e,t,o,l){if((l=l||open("","_blank"))&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof e)return a(e,t,o);var r="application/octet-stream"===e.type,s=/constructor/i.test(n.HTMLElement)||n.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&s||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=e:location=e,l=null},d.readAsDataURL(e)}else{var p=n.URL||n.webkitURL,m=p.createObjectURL(e);l?l.location=m:location.href=m,l=null,setTimeout((function(){p.revokeObjectURL(m)}),4e4)}});n.saveAs=s.saveAs=s,e.exports=s}()}(J)),J.exports);const W=e("F",i(K)),V={ADD_EMPLOYEE:"add_employee"},Z="middle",ee=X(s({name:"EmployeePage",__name:"index",setup(e){c((e=>({"7409e97b":`${E(i).borderRadiusLG}px`,cbd343c2:E(i).colorBorderSecondary,f3bc2380:`${E(i).paddingLG}px`,"481f00b3":E(i).colorBgContainer,"5282cf6e":E(r)&&"transparent",f59824dc:E(r)?E(i).colorPrimary:E(i).colorPrimaryHover})));const{isDark:r}=a(),{token:i}=I(),{t:s}=d(),X=A((()=>n((()=>t.import("./role-modal-legacy-CnMYmqwC.js")),void 0))),Y=A((()=>n((()=>t.import("./import-excel-modal-legacy-D0t3mDiG.js")),void 0))),J=A((()=>n((()=>t.import("./mass-notification-legacy-CWTPEhJ2.js")),void 0))),K=p(),ee=m({departmentId:K.value?.[0]?.id??1,keyword:"",page:1,pagesize:10}),te=u(!1),ae=y((()=>[{title:s("employee.table.columns.staffPhoto"),dataIndex:"staffPhoto",key:"staffPhoto",width:80},{title:s("employee.table.columns.username"),dataIndex:"username",key:"username"},{title:s("employee.table.columns.mobile"),dataIndex:"mobile",key:"mobile"},{title:s("employee.table.columns.workNumber"),dataIndex:"workNumber",key:"workNumber"},{title:s("employee.table.columns.formOfEmployment"),dataIndex:"formOfEmployment",key:"formOfEmployment"},{title:s("employee.table.columns.departmentName"),dataIndex:"departmentName",key:"departmentName"},{title:s("employee.table.columns.timeOfEntry"),dataIndex:"timeOfEntry",key:"timeOfEntry"},{title:s("employee.table.columns.operations"),key:"operations",fixed:"right",width:180}])),oe=f({total:0,rows:[]}),le=u(!1),ne=u(null),re=["bottomRight"],ie=["5","10","20","30","40","50"],{loading:se,run:ce}=o(P.getCompanyDepartmentList,{manual:!0,onSuccess:({data:e})=>{K.value=M.toTree(e)}}),{loading:de,run:pe}=o((()=>T.getEmployeeList(ee)),{manual:!0,onSuccess:({data:e})=>{oe.rows=e.rows.map((e=>({...e,key:e.id}))),oe.total=e.total}}),{run:me}=o(T.deleteEmployee,{manual:!0,onSuccess:()=>{B.success(s("employee.messages.deleteSuccess")),pe(ee)},onError:e=>{e.message?B.error(e.message):B.error(s("employee.messages.deleteError"))}}),{run:ue,loading:ye}=o(T.exportEmployeeList,{manual:!0,onSuccess:e=>{console.log(e),W.saveAs(e.data,"员工列表.xlsx")}}),fe=e=>{ee.departmentId=Number(e[0])},ge=(e,t)=>{ee.page=e,ee.pagesize=t,pe(ee)};g((()=>ee.departmentId),(e=>{pe(ee)})),v((async()=>{await Promise.all([ce(),pe()])}));const ve={[D.Formal]:y((()=>s("employee.table.formalOfEmployment.formal"))),[D.InFormal]:y((()=>s("employee.table.formalOfEmployment.informal")))},be=u([]),we=u({onChange(e,t){be.value=t.map((e=>({id:e.id,username:e.username})))}}),ke=u(!1),he=()=>{be.value.length>0?ke.value=!0:B.warning(s("employee.messages.noSelectedEmployee")),console.log(ke.value)};return(e,t)=>{const a=b("permission");return k(),w(E(F),{gap:"small",class:"h-full employee-wrapper"},{default:h((()=>[_(E(F),{vertical:"",class:"employee-left",gap:"middle"},{default:h((()=>[_(E(N),{onSearch:t[0]||(t[0]=e=>E(pe)(ee)),placeholder:E(s)("employee.search.placeholder"),value:ee.keyword,"onUpdate:value":t[1]||(t[1]=e=>ee.keyword=e)},null,8,["placeholder","value"]),_(E(U),{loading:E(se),active:"",title:!1,paragraph:{rows:16}},{default:h((()=>[E(se)?x("",!0):(k(),w(E(H),{key:0,class:"draggable-tree h-full",draggable:"","block-node":"","tree-data":K.value,"default-expand-all":"",onSelect:fe},null,8,["tree-data"]))])),_:1},8,["loading"])])),_:1}),_(E(F),{vertical:"",gap:"small",class:"flex-1 employee-right h-full"},{default:h((()=>[_(E(F),{justify:"space-between",class:"employee-right-actions"},{default:h((()=>[_(E(q),{size:Z,onClick:he},{default:h((()=>[j(O(E(s)("employee.actions.sendNotification")),1)])),_:1}),_(E(F),{gap:"small"},{default:h((()=>[L((k(),w(E(q),{type:"primary",size:Z,onClick:t[2]||(t[2]=()=>{l.push("/employee/detail")})},{default:h((()=>[j(O(E(s)("employee.actions.addEmployee")),1)])),_:1})),[[a,E(V).ADD_EMPLOYEE]]),_(E(q),{size:Z,onClick:t[3]||(t[3]=e=>te.value=!0)},{default:h((()=>[j(O(E(s)("employee.actions.importExcel")),1)])),_:1}),_(E(q),{loading:E(ye),size:Z,onClick:E(ue)},{default:h((()=>[j(O(E(s)("employee.actions.exportExcel")),1)])),_:1},8,["loading","onClick"])])),_:1})])),_:1}),_(E(z),{spinning:E(de),"wrapper-class-name":"flex-1 h-full"},{default:h((()=>[_(E(G),{pagination:{position:re,pageSizeOptions:ie,total:E(oe).total,current:ee.page,onChange:ge,showTotal:e=>E(s)("employee.table.pagination.total",{total:e})},class:"flex-1 h-full employee-right-table",columns:ae.value,"data-source":E(oe).rows,"row-selection":we.value},{headerCell:h((({title:e})=>[_(E(Q),{type:"secondary",level:5,class:"table-header-title"},{default:h((()=>[j(O(e),1)])),_:2},1024)])),bodyCell:h((({column:e,record:t})=>{return["staffPhoto"===e.key?(k(),w(E(R),{key:0,src:t.staffPhoto},null,8,["src"])):"formOfEmployment"===e.key?(k(),C(S,{key:1},[j(O((a=t.formOfEmployment,ve[a].value)),1)],64)):"operations"===e.key?(k(),w(E(F),{key:2},{default:h((()=>[_(E(q),{type:"link",size:"small",onClick:e=>{return a=t.key,void l.push(`/employee/detail/${a}`);var a}},{default:h((()=>[j(O(E(s)("employee.table.actions.view")),1)])),_:2},1032,["onClick"]),_(E(q),{type:"link",size:"small",onClick:e=>{return a=t.key,le.value=!0,void(ne.value=a);var a}},{default:h((()=>[j(O(E(s)("employee.table.actions.role")),1)])),_:2},1032,["onClick"]),_(E($),{onConfirm:e=>E(me)(t.key),title:E(s)("employee.table.actions.deleteConfirm")},{default:h((()=>[_(E(q),{type:"link",size:"small",danger:""},{default:h((()=>[j(O(E(s)("employee.table.actions.delete")),1)])),_:1})])),_:2},1032,["onConfirm","title"])])),_:2},1024)):x("",!0)];var a})),_:1},8,["pagination","columns","data-source","row-selection"])])),_:1},8,["spinning"]),_(E(X),{open:le.value,"onUpdate:open":t[4]||(t[4]=e=>le.value=e),"employee-id":ne.value},null,8,["open","employee-id"]),_(E(Y),{open:te.value,"onUpdate:open":t[5]||(t[5]=e=>te.value=e)},null,8,["open"]),_(E(J),{open:ke.value,"onUpdate:open":t[6]||(t[6]=e=>ke.value=e),employees:be.value},null,8,["open","employees"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-6d0c557e"]]),te=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));e("i",te)}}}));
