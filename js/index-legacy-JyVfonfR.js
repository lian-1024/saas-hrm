System.register(["./index-legacy-FCYPyWIL.js","./vue-vendor-legacy-x9FjLCOD.js","./skeleton-legacy-KE-_dRl6.js","./spin-legacy-NTWxnDiJ.js","./index-legacy-CHUU-5It.js","./department.service-legacy-BkPFY2K_.js","./vue3-count-to.esm-legacy-jOYS7Gk9.js","./antd-vendor-legacy-C9XdHwF7.js","./_plugin-vue_export-helper-legacy-DgAO6S8O.js"],(function(e,t){"use strict";var a,n,d,o,l,r,c,s,u,i,p,m,f,g,y,v,x,b,I,k,h,_,O,w,j,R,S,$,C,L,N,T,z,A,D;return{setters:[e=>{a=e.i,n=e.u,d=e._},e=>{o=e.d,l=e.a9,r=e.u,c=e.a5,s=e.r,u=e.a,i=e.w,p=e.a2,m=e.a3,f=e.a4,g=e.c,y=e.ah,v=e.G,x=e.ad,b=e.a7,I=e.F,k=e.aj,h=e.ae,_=e.h},e=>{O=e.Q},e=>{w=e.Q},e=>{j=e.u},e=>{R=e.D},e=>{S=e.C},e=>{$=e.F,C=e.O,L=e.B,N=e.Z,T=e.$,z=e.a0,A=e.a1},e=>{D=e._}],execute:function(){const P=e("A",{1:{text:"正常",color:"#52c41a"},2:{text:"旷工",color:"#ff4d4f"},3:{text:"迟到",color:"#faad14"},4:{text:"早退",color:"#faad14"},5:{text:"外出",color:"#1890ff"},6:{text:"出差",color:"#1890ff"},7:{text:"年假",color:"#52c41a"},8:{text:"事假",color:"#faad14"},9:{text:"病假",color:"#faad14"},10:{text:"婚假",color:"#52c41a"},11:{text:"丧假",color:"#8c8c8c"},12:{text:"产假",color:"#52c41a"},13:{text:"奖励产假",color:"#52c41a"},14:{text:"陪产假",color:"#52c41a"},15:{text:"探亲假",color:"#52c41a"},16:{text:"工伤假",color:"#faad14"},17:{text:"调休",color:"#52c41a"},18:{text:"产检假",color:"#52c41a"},19:{text:"流产假",color:"#faad14"},20:{text:"长期病假",color:"#faad14"},21:{text:"补签",color:"#1890ff"},22:{text:"休息",color:"#8c8c8c"},99:{text:"-",color:"#8c8c8c"}});class U{static getAttendanceList(e){return a.get("/attendances",{params:e})}static getCompanyList(){return a.get("/company/list")}static updateCompanyList(e){return a.put("/company/list",{data:e})}static updateAttendance(e,t){return a.put(`/attendances/${e}`,{data:t})}static getAttendancesAdtStatuList(e){return a.get("/attendances/adtStatu/list",{params:{userId:e}})}}e("a",U);const B={class:"attendance-middle-checkbox-group"},G={class:"attendance-table"},M=D(o({name:"AttendancePage",__name:"index",setup(e){l((e=>({"6a78231f":`${r(F).paddingLG}px`,"2c753592":r(F).colorBgContainer,"0dfce7fc":`${r(F).borderRadiusLG}px`,"4c790b7e":r(F).colorBorderSecondary,"8b2ca8e4":`${r(F).fontSizeLG}px`,"61ab6ef2":`${r(F).fontSizeXL}px`,"11b6d538":`${r(F).padding}px`,65500879:r(F).colorBgElevated})));const a=h((()=>d((()=>t.import("./table-popover-legacy-BONw_1tA.js")),void 0))),o=h((()=>d((()=>t.import("./modal-legacy-C150qCfv.js")),void 0))),D=h((()=>d((()=>t.import("./update-attendance-legacy-pGhkRi62.js")),void 0))),M=h((()=>d((()=>t.import("./drawer-legacy-DjxaYW61.js").then((e=>e.d))),void 0))),{token:F}=j(),{t:Q}=c(),E=s([]),X=s([]),Z=s(!1),q=s(!1),H=s(!1),J=[{title:Q("attendance.table.columns.key"),dataIndex:"key",key:"key",width:80,fixed:"left"},{title:Q("attendance.table.columns.username"),dataIndex:"username",key:"username",width:150,fixed:"left"},{title:Q("attendance.table.columns.workNumber"),dataIndex:"workNumber",key:"workNumber",width:150,fixed:"left"},{title:Q("attendance.table.columns.departmentName"),dataIndex:"departmentName",key:"departmentName",width:150,fixed:"left"},{title:Q("attendance.table.columns.mobile"),dataIndex:"mobile",key:"mobile",width:150,fixed:"left"}],K=s(J),V=u({total:0,rows:[]}),W=u({monthOfReport:1,tobeTaskCount:0,dayOfMonth:0,yearOfReport:2026,attendanceRecord:[]}),Y=u({page:1,pagesize:10,deptID:X.value.join(",")}),ee=u({day:"",adtStatu:0,userId:0,departmentId:0}),te=e=>{const t=[],{yearOfReport:n,monthOfReport:d}=W;for(let o=1;o<=e;o++){const e=`${n}/${d}/${o}`;t.push({title:`${d}/${o}`,dataIndex:e,key:e,width:80,align:"center",customRender:({text:t,record:l})=>{const r=l.attendanceRecord.find((t=>t.day===e));return P[t]?_(a,{username:l.username,yearOfReport:n,monthOfReport:d,dayOfReport:o,adtStatu:t,adtInTime:r?.adtInTime,adtOutTime:r?.adtOutTime,adtInPlace:r?.adtInPlace,adtOutPlace:r?.adtOutPlace,onClick:()=>{ee.userId=l.id??0,ee.departmentId=l.departmentId,ee.day=e,ee.adtStatu=t,H.value=!0}}):t}})}return t},ae=(e,t)=>{Object.assign(Y,{page:e,pagesize:t}),ne(Y)},{run:ne,loading:de}=n(U.getAttendanceList,{onSuccess:({data:e})=>{const{yearOfReport:t,monthOfReport:a,tobeTaskCount:n,data:{rows:d}}=e;Object.assign(W,{tobeTaskCount:n,dayOfMonth:new Date(t,a,0).getDate(),attendanceRecord:d,yearOfReport:t,monthOfReport:a}),V.rows=(e=>{const{yearOfReport:t,monthOfReport:a}=W;return e.map((e=>({key:e.id,id:e.id,departmentId:e.departmentId,departmentName:e.departmentName,mobile:e.mobile,username:e.username,workNumber:e.workNumber,attendanceRecord:e.attendanceRecord,...e.attendanceRecord.reduce(((e,n)=>{const d=parseInt(n.day.slice(6));return{...e,[`${t}/${a}/${d}`]:n.adtStatu}}),{})})))})(d),V.total=e.data.total}}),{loading:oe}=n(R.getCompanyDepartmentList,{onSuccess:({data:e})=>{E.value=e.map((e=>({label:e.name,value:e.id})))}});return i((()=>W.dayOfMonth),(e=>{e>0&&(K.value=[...J,...te(e)])})),i((()=>X.value),(()=>{Y.deptID=X.value.join(","),ne(Y)})),(e,t)=>(m(),p(r($),{class:"attendance-wrapper h-full",vertical:"",gap:"middle"},{default:f((()=>[g(r($),{justify:"space-between",align:"center",class:"attendance-top"},{default:f((()=>[g(r($),{vertical:"",align:"center",gap:"small"},{default:f((()=>[g(r(C),{class:"attendance-top-title"},{default:f((()=>[v(x(r(Q)("attendance.top.unprocessed")),1)])),_:1}),g(r(O),{paragraph:!1,active:"",loading:r(de)},{default:f((()=>[g(r(S),{"start-val":0,"end-val":W.tobeTaskCount,duration:3e3,class:"attendance-top-total"},null,8,["end-val"])])),_:1},8,["loading"])])),_:1}),g(r($),{gap:"middle"},{default:f((()=>[g(r(L),{onClick:t[0]||(t[0]=e=>Z.value=!0)},{default:f((()=>[v(x(r(Q)("attendance.actions.clockInRange")),1)])),_:1}),g(r(L),{type:"primary",onClick:t[1]||(t[1]=e=>q.value=!0)},{default:f((()=>[v(x(r(Q)("attendance.actions.settings")),1)])),_:1})])),_:1})])),_:1}),g(r($),{class:"attendance-middle",gap:"small",align:"flex-start"},{default:f((()=>[g(r(N),{class:"attendance-middle-label",level:5},{default:f((()=>[v(x(r(Q)("attendance.filter.department"))+": ",1)])),_:1}),g(r(O),{active:"",title:!1,loading:r(oe),paragraph:{rows:2}},{default:f((()=>[g(r(T),{value:X.value,"onUpdate:value":t[2]||(t[2]=e=>X.value=e),class:"w-full"},{default:f((()=>[y("div",B,[(m(!0),b(I,null,k(E.value,(e=>(m(),p(r(z),{key:e.value.toString(),value:e.value},{default:f((()=>[v(x(e.label),1)])),_:2},1032,["value"])))),128))])])),_:1},8,["value"])])),_:1},8,["loading"])])),_:1}),y("div",G,[g(r(w),{spinning:r(de)},{default:f((()=>[g(r(A),{pagination:{position:["bottomCenter"],pageSize:Y.pagesize,total:V.total,current:Y.page,onChange:ae,showTotal:e=>r(Q)("attendance.table.pagination.total",{total:e})},columns:K.value,"data-source":V.rows,scroll:{x:"max-content"},bordered:""},null,8,["pagination","columns","data-source"])])),_:1},8,["spinning"])]),g(r(M),{open:Z.value,"onUpdate:open":t[3]||(t[3]=e=>Z.value=e)},null,8,["open"]),g(r(o),{open:q.value,"onUpdate:open":t[4]||(t[4]=e=>q.value=e)},null,8,["open"]),g(r(D),{day:ee.day,adtStatu:ee.adtStatu,userId:ee.userId,departmentId:ee.departmentId,open:H.value,"onUpdate:open":t[5]||(t[5]=e=>H.value=e),onUpdate:t[6]||(t[6]=e=>r(ne)(Y))},null,8,["day","adtStatu","userId","departmentId","open"])])),_:1}))}}),[["__scopeId","data-v-bef77a1a"]]),F=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"}));e("i",F)}}}));
