const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/add-role-modal-yRWJwCDN.js","js/vue-vendor-I_PSXyJa.js","js/role.service-BC77x9tf.js","js/index-CI1igBQZ.js","js/antd-vendor-T3zku5__.js","js/lodash-vendor-DOy_biNW.js","js/axios-vendor-cIIFlI1p.js","js/modal.vue_vue_type_script_setup_true_lang-BwdYvTp8.js","js/index-YJ2Yz_0y.js","js/status-Bkxi8BcS.js","js/_plugin-vue_export-helper-DlAUqK2U.js","js/give-permission-modal-BwOvYbkJ.js","js/permission-hpmuV9DS.js","js/skeleton-DY1tZivi.js"])))=>i.map(i=>d[i]);
import{u as w,_ as I}from"./index-CI1igBQZ.js";import{d as ee,a9 as ae,u as a,a5 as te,r as R,a as M,j as oe,o as ne,a2 as f,a3 as r,a4 as l,c as s,G as c,ad as p,a7 as v,an as $,F as y,ae as T}from"./vue-vendor-I_PSXyJa.js";import{Q as le}from"./spin-f7H7F6Je.js";import{u as se}from"./index-YJ2Yz_0y.js";import{R as E}from"./role.service-BC77x9tf.js";import{h as _,B as ie,a1 as re,al as de,av as ue,S as ce,u as pe,F as B,aa as k,ah as x,O as me,aw as ge}from"./antd-vendor-T3zku5__.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-vendor-cIIFlI1p.js";import"./lodash-vendor-DOy_biNW.js";const ve=ee({name:"RolePage",__name:"index",setup(ye){ae(e=>({"2daf96c4":"".concat(a(b).paddingLG,"px"),a9b571de:a(b).colorBgContainer,"1866eddd":"".concat(a(b).borderRadiusLG,"px"),"2c937506":a(b).colorBorderSecondary}));const{t:d}=te(),{token:b}=se(),L=T(()=>I(()=>import("./add-role-modal-yRWJwCDN.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),D=T(()=>I(()=>import("./give-permission-modal-BwOvYbkJ.js"),__vite__mapDeps([11,1,12,3,4,5,6,2,7,8,13,10]))),A=["name","state","description"],O=[{title:d("role.table.columns.key"),dataIndex:"id",key:"key"},{title:d("role.table.columns.role"),dataIndex:"name",key:"name"},{title:d("role.table.columns.status"),dataIndex:"state",key:"state"},{title:d("role.table.columns.description"),dataIndex:"description",key:"description"},{title:d("role.table.columns.actions"),key:"actions"}],S=R(!1),P=R(),g=R({total:0,rows:[]}),m=M({page:1,pagesize:10}),h=R(!1),i=M({}),{run:C,loading:U}=w(()=>E.getRoleList(m),{manual:!0,onSuccess:({data:e})=>{g.value=e}}),{run:V,loading:z}=w(E.updateRole,{manual:!0,onSuccess:()=>{_.success(d("role.table.operationMessage.editRoleSuccess"))},onError:e=>{_.error(e.message||d("role.table.operationMessage.editRoleError"))}}),{run:G}=w(E.deleteRoleById,{manual:!0,onSuccess:()=>{_.success(d("role.table.operationMessage.deleteRoleSuccess")),C()},onError:e=>{_.error(e.message||d("role.table.operationMessage.deleteRoleError"))}}),Q=e=>{P.value=e,S.value=!0},F=e=>{i[e]=ge(g.value.rows.filter(o=>o.id===e)[0])},N=async e=>{const o=i[e];V(o).then(()=>Object.assign(g.value.rows.filter(t=>t.id===e)[0],o)).finally(()=>{delete i[e]})},j=e=>{delete i[e]},q=async e=>{P.value=e,await G(e)},H=async(e,o)=>{m.page=e,m.pagesize=o,await C(m)},J=["bottomCenter"],K=["5","10","20","30","40","50"],W=(e,o)=>{i[o.id].state=e?1:0},X=()=>{const e=Math.ceil((g.value.total+1)/m.pagesize);m.page=e,C(m)},Y=oe(()=>e=>{var o;return((o=i[e])==null?void 0:o.state)===1});return ne(async()=>{await C()}),(e,o)=>(r(),f(a(B),{class:"role-wrapper",vertical:"",align:"start",gap:"middle"},{default:l(()=>[s(a(ie),{type:"primary",onClick:o[0]||(o[0]=t=>h.value=!0)},{default:l(()=>[c(p(e.$t("role.table.actions.addRole")),1)]),_:1}),s(a(le),{spinning:a(U)||a(z),"wrapper-class-name":"flex-1 w-full"},{default:l(()=>[s(a(re),{class:"w-full",pagination:{position:J,pageSizeOptions:K,onChange:H,total:g.value.total,current:m.page},columns:O,dataSource:g.value.rows,bordered:""},{headerCell:l(({title:t})=>[s(a(me),{type:"secondary"},{default:l(()=>[c(p(t),1)]),_:2},1024)]),bodyCell:l(({column:t,record:n,text:Z})=>[A.includes(String(t.dataIndex))?(r(),v(y,{key:0},[i[n.id]?(r(),v(y,{key:0},[t.key==="name"?(r(),f(a(de),{key:0,value:i[n.id][t.key],"onUpdate:value":u=>i[n.id][t.key]=u},null,8,["value","onUpdate:value"])):t.key==="description"?(r(),f(a(ue),{key:1,value:i[n.id][t.key],"onUpdate:value":u=>i[n.id][t.key]=u},null,8,["value","onUpdate:value"])):t.key==="state"?(r(),f(a(ce),{key:2,checked:Y.value(n.id),onChange:u=>W(u,n)},null,8,["checked","onChange"])):$("",!0)],64)):(r(),v(y,{key:1},[t.key==="state"?(r(),f(a(pe),{key:0,color:n.state?"blue":"default"},{default:l(()=>[c(p(n.state?e.$t("common.enable.enable"):e.$t("common.enable.disable")),1)]),_:2},1032,["color"])):(r(),v(y,{key:1},[c(p(Z),1)],64))],64))],64)):$("",!0),t.key==="actions"?(r(),f(a(B),{key:1,gap:"small",wrap:"wrap"},{default:l(()=>[i[n.id]?(r(),v(y,{key:1},[s(a(k),{onClick:u=>N(n.id)},{default:l(()=>[c(p(e.$t("role.table.actions.save")),1)]),_:2},1032,["onClick"]),s(a(x),{title:e.$t("role.table.operationMessage.cancelConfirmTitle"),onConfirm:u=>j(n.id)},{default:l(()=>[s(a(k),null,{default:l(()=>[c(p(e.$t("role.table.actions.cancel")),1)]),_:1})]),_:2},1032,["title","onConfirm"])],64)):(r(),v(y,{key:0},[s(a(k),{onClick:u=>Q(n.id)},{default:l(()=>[c(p(e.$t("role.table.actions.givePermission")),1)]),_:2},1032,["onClick"]),s(a(k),{onClick:u=>F(n.id)},{default:l(()=>[c(p(e.$t("role.table.actions.edit")),1)]),_:2},1032,["onClick"]),s(a(x),{title:a(d)("role.table.operationMessage.deleteConfirmTitle"),onConfirm:u=>q(n.id)},{default:l(()=>[s(a(k),null,{default:l(()=>[c(p(e.$t("role.table.actions.delete")),1)]),_:1})]),_:2},1032,["title","onConfirm"])],64))]),_:2},1024)):$("",!0)]),_:1},8,["pagination","dataSource"])]),_:1},8,["spinning"]),s(a(L),{onSuccess:X,open:h.value,"onUpdate:open":o[1]||(o[1]=t=>h.value=t)},null,8,["open"]),s(a(D),{"role-id":P.value,open:S.value,"onUpdate:open":o[2]||(o[2]=t=>S.value=t)},null,8,["role-id","open"])]),_:1}))}}),Ee=fe(ve,[["__scopeId","data-v-d0294372"]]);export{Ee as default};
